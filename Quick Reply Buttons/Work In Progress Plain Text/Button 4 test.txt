/setvar key=catgen "Personality Traits And Quirks"|
/setvar key=genid "4"|


//setvar key=swipe Yes|

/:"Character Maker V4.Get Char info"|



/setvar key=i Continue|
/while left=i right=Continue rule=eq {:
	/setvar key=postr Redo |
	/while left=postr right=Redo rule=eq {:
		/echo Generateing Positive Traits|
		/len {{getvar::postrs}}| /setvar key=l1 {{pipe}}|
		/wordcount {{getvar::temp}}| /setvar key=l2 {{pipe}}|
		/foreach var=postrs {:
			/ife {: /test left=l1 right=1 rule=neq :}|
				/then {:
					/ife {: /test left={{index}} right=0 rule=neq :}|
						/then {: /addvar key=temp ", {{item}}":}|
					/else {: /setvar key=temp " Avoid these positive traits {{item}}. ":}|
				:}|
			/else {: 
				/ife {: /test left=l2 right=1 rule=gte :}|
					/then {:
						/setvar key=temp " Avoid these positive traits {{item}}. "
					:}|
				/else {:
					/setvar key=temp " Avoid this positive trait {{item}}. "
					:}|
			:}|
		:}|
		/ife {: /test left=l2 right=1 rule=gte :}|
			/then {:
				/ife {: /test left=l1 right=1 rule=gte :}|
					/then {: /addvar key=temp ", {{getvar::t1}}"
				:}|
				/else {: 
					/setvar key=temp " Don't use any of these positive traits {{getvar::t1}}. "
				:}|
			:}|
		
		/ife {: /test left=l1 right=1 rule=gte:}|
			/then {: /addvar key=temp ". " :}|
		/elseif {: /test left=l1 right=1 rule=gte:}|
			/then {: /addvar key=temp ". " :}|
		
		/setvar key=system {{noop}}|
		/setvar key=prompt {{noop}}|
		/setvar key=instruct {{noop}}|
		
		//Button 04 - 01|
		/getentryfield file="Character Maker Combined NSFW GenRaw" 166|
		/setvar key=system {{pipe}}|
		/getentryfield file="Character Maker Combined NSFW GenRaw" 167|
		/setvar key=prompt {{pipe}}|
		/getentryfield file="Character Maker Combined NSFW GenRaw" 168|
		/setvar key=instruct {{pipe}}|

		/genraw lock=on name={{char}} 
		system="{{getvar::system}}"
{{getvar::prompt}}
{{getvar::instruct}}|

		/setvar key=t1 {{pipe}}|
		/re-replace replace="" find="/\./" var=t1| /setvar key=t1 {{pipe}}|
		/split var=t1|
		/setvar key=poslist {{pipe}}|
		
		/addvar key=poslist Manual input|
		/addvar key=poslist Redo|
		/buttons labels={{getvar::poslist}} Is any of these positive traits anything you want you want for {{getvar::fname}}?|
		/setvar key=postr {{pipe}} |
		/ife {: /test left=postr right="" rule=eq :}|
			/then {:/:"Character Maker V4.Flushvar"| /echo Aborting | /abort:}|
		/elseif {: /test left=postr right="Manual input" rule=eq :}|
			/then {:
				/input rows=8  Add the positive trait you want.|
				/setvar key=postr {{pipe}}|
				/ife {: /test left=p1 right="" rule=eq :}|
					/then {: /:"Character Maker V4.Flushvar"| /echo Aborting | /abort :}|
				
			:}|
	
	:}|
	/addvar key=postrs {{getvar::postr}}|
	/buttons labels=["Continue","Done"]Do you want to continue adding positive traits?|
	/setvar key=i {{pipe}}|
	/ife {: /test left=i right="" rule=eq :}|
		/then {: /:"Character Maker V4.Flushvar"| /echo Aborting | /abort :}|
:}|


/setvar key=i Continue|
/while left=i right=Continue rule=eq {:
	/setvar key=postr Redo |
	/while left=postr right=Redo rule=eq {:
		/echo Generateing Negative Traits|
		/len {{getvar::negtrs}}| /setvar key=l1 {{pipe}}|
		/wordcount {{getvar::temp}}| /setvar key=l2 {{pipe}}|
		/foreach var=negtrs {:
			/ife {: /test left=l1 right=1 rule=neq :}|
				/then {:
					/ife {: /test left={{index}} right=0 rule=neq :}|
						/then {: /addvar key=temp ", {{item}}":}|
					/else {: /setvar key=temp " Don't use any of these negative traits {{item}}. ":}|
				:}|
			/else {: 
				/ife {: /test left=l2 right=1 rule=gte :}|
					/then {:
						/setvar key=temp " Don't use any of these negative traits {{item}}. "
					:}|
				/else {:
					/setvar key=temp " Don't use this negative trait {{item}}. "
					:}|
			:}|
		:}|
		/ife {: /test left=l2 right=1 rule=gte :}|
			/then {:
				/ife {: /test left=l1 right=1 rule=gte :}|
					/then {: /addvar key=temp ", {{getvar::t1}}"
				:}|
				/else {: 
					/setvar key=temp " Don't use any of these negative traits {{getvar::t1}}. "
				:}|
			:}|
		/ife {: /test left=l1 right=1 rule=gte:}|
			/then {: /addvar key=temp ". " :}|
		/elseif {: /test left=l1 right=1 rule=gte:}|
			/then {: /addvar key=temp ". " :}|
		
		/setvar key=system {{noop}}|
		/setvar key=prompt {{noop}}|
		/setvar key=instruct {{noop}}|
		
		//Button 04 - 01|
		/getentryfield file="Character Maker Combined NSFW GenRaw" 170|
		/setvar key=system {{pipe}}|
		/getentryfield file="Character Maker Combined NSFW GenRaw" 171|
		/setvar key=prompt {{pipe}}|
		/getentryfield file="Character Maker Combined NSFW GenRaw" 172|
		/setvar key=instruct {{pipe}}|
		
		/genraw lock=on name={{char}} 
		system="{{getvar::system}}"
{{getvar::prompt}}
{{getvar::instruct}}|

		/setvar key=t1 {{pipe}}|
		/re-replace replace="" find="/\./" var=t1| /setvar key=t1 {{pipe}}|
		/split var=t1|
		/setvar key=neglist {{pipe}}|
		
		/addvar key=neglist Manual input|
		/addvar key=neglist Redo|
		/buttons labels={{getvar::neglist}} Is any of these negative traits something you want you want for {{getvar::fname}}?|
		/setvar key=postr {{pipe}} |
		/ife {: /test left=postr right="" rule=eq :}|
			/then {:/:"Character Maker V4.Flushvar"| /echo Aborting | /abort:}|
		/elseif {: /test left=postr right="Manual input" rule=eq :}|
			/then {:
				/input rows=8  Add the negative trait you want.|
				/setvar key=postr {{pipe}}|
				/ife {: /test left=p1 right="" rule=eq :}|
					/then {: /:"Character Maker V4.Flushvar"| /echo Aborting | /abort :}|
				
			:}|
	
	:}|
	/addvar key=negtrs {{getvar::postr}}|
	/buttons labels=["Continue","Done"]Do you want to continue adding negative traits?|
	/setvar key=i {{pipe}}|
	/ife {: /test left=i right="" rule=eq :}|
		/then {: /:"Character Maker V4.Flushvar"| /echo Aborting | /abort :}|
:}|

/ife {: /test left=species right=Human rule=eq:}|
	/then {: /setvar key=isTrue false :}|
/elseif {: /test left=species right=Demi-Human rule=in:}|
	/then {: /setvar key=isTrue false :}|
/elseif {: /test left=species right=Anthro rule=in:}|
	/then {: /setvar key=isTrue false :}|
/elseif {: /test left=species right=Beastkin rule=in:}|
	/then {: /setvar key=isTrue false :}|
/elseif {: /test left=species right=Pokémon rule=in:}|
	/then {: /setvar key=isTrue true :}|
/elseif {: /test left=species right=Animal rule=in:}|
	/then {: /setvar key=isTrue true :}|
/else {: /setvar key=isTrue true :}|

/setvar key=human_traits {{noop}}|

/ife {: /test left=isTrue right=true rule=eq:}|
	/then {:
		/setvar key=genState Redo|
		
		/while left=genState right=Redo rule=eq {:
			/echo Generating Human Trait|
			/setvar key=genState []|  
			
			/setvar key=system {{noop}}|
			/setvar key=prompt {{noop}}|
			/setvar key=instruct {{noop}}|
			
			//Button 04 - 03|
			/getentryfield file="Character Maker Combined NSFW GenRaw" 174|
			/setvar key=system {{pipe}}|
			/getentryfield file="Character Maker Combined NSFW GenRaw" 175|
			/setvar key=prompt {{pipe}}|
			/getentryfield file="Character Maker Combined NSFW GenRaw" 176|
			/setvar key=instruct {{pipe}}|
			
			/genraw lock=on name={{char}} 
			system="{{getvar::system}}"
{{getvar::prompt}}
{{getvar::instruct}}|

			/setvar key=t {{pipe}}|
			/re-replace replace="" find="/\./" var=t | /setvar key=t {{pipe}}|
			/split var=t | 
			/setvar key=genState {{pipe}}|
			/addvar key=genState "Manually add to List"|
			/addvar key=genState Done|
			/addvar key=genState Redo|
		
			/buttons labels={{getvar::genState}} Select the Human trait you want {{getvar::fname}} to have.|
		
			/setvar key=selected_btn {{pipe}}|
		
			/ife {: /test left=selected_btn right="" rule=eq :}|
				/then {:/:"Character Maker V4.Flushvar"| /echo Aborting | /abort:}|
			/elseif {: /test left={{getvar::selected_btn}} right="Manually add to List" rule=eq :}|
				/then {:
					
					/input rows=8 Add the Human trait you want {{getvar::fname}} to have.|
					/setvar key=t {{pipe}}|
					/setvar key=genState Redo|
					/ife {: /test left=t right="" rule=eq :}|
						/then {:/:"Character Maker V4.Flushvar"| /echo Aborting | /abort:}|
					/elseif {: /test left={{getvar::outputString}} right="" rule=neq :}|
					/then {:
						/addvar key=outputString ", {{getvar::t}}"|
					:}|
					/else {:
						/setvar key=outputString {{getvar::t}}|
					:}|
				:}|
			/elseif {: /test left={{getvar::selected_btn}} right=Done rule=eq :}|
				/then {::}|
			/elseif {: /test left={{getvar::selected_btn}} right=Redo rule=neq :}|
				/then {:
					/ife {: /test left={{getvar::outputString}} right="" rule=neq :}|
						/then {:
							/addvar key=outputString ", {{getvar::selected_btn}}"|
							/setvar key=genState Redo
						:}|
						/else {:
							/setvar key=outputString {{getvar::selected_btn}}|
							/setvar key=genState Redo
						:}|
				:}|
			/else  {: /setvar key=genState Redo :}|
		:}|
		
		/setvar key=human_traits "Human traits: {{getvar::outputString}}"|
:}|

/ife {: /test left=species right=Human rule=eq:}|
	/then {: /setvar key=isTrue false :}|
/elseif {: /test left=species right=Demi-Human rule=in:}|
	/then {: /setvar key=isTrue false :}|
/elseif {: /test left=species right=Anthro rule=in:}|
	/then {: /setvar key=isTrue false :}|
/elseif {: /test left=species right=Beastkin rule=in:}|
	/then {: /setvar key=isTrue false :}|
/elseif {: /test left=species right=Pokémon rule=in:}|
	/then {: /setvar key=isTrue true :}|
/elseif {: /test left=species right=Animal rule=in:}|
	/then {: /setvar key=isTrue true :}|
/else {: /setvar key=isTrue true :}|


/setvar key=non-human_traits {{noop}}|

/ife {: /test left=isTrue right=true rule=eq:}|
	/then {:
		/setvar key=genState Redo|
		/re-replace replace="" find="/\b(Demi-Human\|Anthro\|Beastkin\|Animal)\b\s*/" var=species | /setvar key=d2 {{pipe}}|
		/while left=genState right=Redo rule=eq {:
			/echo Generating {{getvar::d2}} Trait|
			/setvar key=genState []|  
			
			/setvar key=system {{noop}}|
			/setvar key=prompt {{noop}}|
			/setvar key=instruct {{noop}}|
			
			//Button 04 - 04|
			/getentryfield file="Character Maker Combined NSFW GenRaw" 178|
			/setvar key=system {{pipe}}|
			/getentryfield file="Character Maker Combined NSFW GenRaw" 179|
			/setvar key=prompt {{pipe}}|
			/getentryfield file="Character Maker Combined NSFW GenRaw" 180|
			/setvar key=instruct {{pipe}}|
			
			/genraw lock=on name={{char}} 
			system="{{getvar::system}}"
{{getvar::prompt}}
{{getvar::instruct}}|

			/setvar key=t {{pipe}}|
			/re-replace replace="" find="/\./" var=t | /setvar key=t {{pipe}}|
			/split var=t | 
			/setvar key=genState {{pipe}}|
			/addvar key=genState "Manually add to List"|
			/addvar key=genState Done|
			/addvar key=genState Redo|
		
			/buttons labels={{getvar::genState}} Select the {{getvar::d2}} trait you want {{getvar::fname}} to have.|
		
			/setvar key=selected_btn {{pipe}}|
		
			/ife {: /test left=selected_btn right="" rule=eq :}|
				/then {:/:"Character Maker V4.Flushvar"| /echo Aborting | /abort:}|
			/elseif {: /test left={{getvar::selected_btn}} right="Manually add to List" rule=eq :}|
				/then {:
					
					/input rows=8 Add the {{getvar::d2}} trait you want {{getvar::fname}} to have.|
					/setvar key=t {{pipe}}|
					/setvar key=genState Redo|
					/ife {: /test left=t right="" rule=eq :}|
						/then {:/:"Character Maker V4.Flushvar"| /echo Aborting | /abort:}|
					/elseif {: /test left={{getvar::outputString}} right="" rule=neq :}|
					/then {:
						/addvar key=outputString ", {{getvar::t}}"|
					:}|
					/else {:
						/setvar key=outputString {{getvar::t}}|
					:}|
				:}|
			/elseif {: /test left={{getvar::selected_btn}} right=Done rule=eq :}|
				/then {::}|
			/elseif {: /test left={{getvar::selected_btn}} right=Redo rule=neq :}|
				/then {:
					/ife {: /test left={{getvar::outputString}} right="" rule=neq :}|
						/then {:
							/addvar key=outputString ", {{getvar::selected_btn}}"|
							/setvar key=genState Redo
						:}|
						/else {:
							/setvar key=outputString {{getvar::selected_btn}}|
							/setvar key=genState Redo
						:}|
				:}|
			/else  {: /setvar key=genState Redo :}|
		:}|
		
		/setvar key=non-human_traits "{{getvar::d2}} Traits: {{getvar::outputString}}"|
:}|





/setvar key=i Continue|
/while left=i right=Continue rule=eq {:
	/setvar key=postr Redo |
	/while left=postr right=Redo rule=eq {:
		/echo Generateing Quirks|
		/len {{getvar::quirks}}| /setvar key=l1 {{pipe}}|
		/wordcount {{getvar::temp}}| /setvar key=l2 {{pipe}}|
		/foreach var=quirks {:
			/ife {: /test left=l1 right=1 rule=neq :}|
				/then {:
					/ife {: /test left={{index}} right=0 rule=neq :}|
						/then {: /addvar key=temp ", {{item}}":}|
					/else {: /setvar key=temp " Avoid these quirks {{item}} ":}|
				:}|
			/else {: 
				/ife {: /test left=l2 right=1 rule=gte :}|
					/then {:
						Don't use any of these quirks {{item}}
					:}|
				/else {:
					/setvar key=temp " Avoid this quirks {{item}}. "
					:}|
			:}|
		:}|
		/ife {: /test left=l2 right=1 rule=gte :}|
			/then {:
				/ife {: /test left=l1 right=1 rule=gte :}|
					/then {: /addvar key=temp ", {{getvar::t1}}"
				:}|
				/else {: 
					/setvar key=temp " Avoid these quirks {{getvar::t1}}. "
				:}|
			:}|
		
		/ife {: /test left=l1 right=1 rule=gte:}|
			/then {: /addvar key=temp ". " :}|
		/elseif {: /test left=l1 right=1 rule=gte:}|
			/then {: /addvar key=temp ". " :}|
		
		/setvar key=system {{noop}}|
		/setvar key=prompt {{noop}}|
		/setvar key=instruct {{noop}}|
		
		//Button 04 - 05|
		/getentryfield file="Character Maker Combined NSFW GenRaw" 182|
		/setvar key=system {{pipe}}|
		/getentryfield file="Character Maker Combined NSFW GenRaw" 183|
		/setvar key=prompt {{pipe}}|
		/getentryfield file="Character Maker Combined NSFW GenRaw" 184|
		/setvar key=instruct {{pipe}}|
		
		/genraw lock=on name={{char}} 
		system="{{getvar::system}}"
{{getvar::prompt}}
{{getvar::instruct}}|

		/setvar key=t1 {{pipe}}|
		/re-replace replace="" find="/\./" var=t1| /setvar key=t1 {{pipe}}|
		/split var=t1|
		/setvar key=qrlist {{pipe}}|
		
		/addvar key=qrlist Manual input|
		/addvar key=qrlist Redo|
		/buttons labels={{getvar::qrlist}} Is any of these quirks you want for {{getvar::fname}}?|
		/setvar key=postr {{pipe}} |
		/ife {: /test left=postr right="" rule=eq :}|
			/then {:/:"Character Maker V4.Flushvar"| /echo Aborting | /abort:}|
		/elseif {: /test left=postr right="Manual input" rule=eq :}|
			/then {:
				
				/input rows=8 Add the quirk you like.|
				/setvar key=postr {{pipe}}|
				/ife {: /test left=p1 right="" rule=eq :}|
					/then {: /:"Character Maker V4.Flushvar"| /echo Aborting | /abort :}|
				
			:}|
	
	:}|
	/addvar key=quirks {{getvar::postr}}|
	/buttons labels=["Continue","Done"]Do you want to continue adding quirks?|
	/setvar key=i {{pipe}}|
	/ife {: /test left=i right="" rule=eq :}|
		/then {: /:"Character Maker V4.Flushvar"| /echo Aborting | /abort :}|
:}|



/setvar key=person Posivite Traits:|
/foreach var=postrs {:
	/ife {: /test left={{index}} right=0 rule=neq :}|
		/then {:
			/addvar key=person ", {{item}}"|
		:}|
	/else {: /addvar key=person " {{item}}":}|
:}|
/addvar key=person "

Negative Traits:"|
/foreach var=negtrs {:
	/ife {: /test left={{index}} right=0 rule=neq :}|
		/then {:
			/addvar key=person ", {{item}}"|
		:}|
	/else {: /addvar key=person " {{item}}":}|
:}|

/ife {: /test left=human_traits right="" rule=neq :}|
	/then {:
		/addvar key=person "

{{getvar::human_traits}}"|
	:}|
/ife {: /test left=non-human_traits right="" rule=neq :}|
	/then {:
		/addvar key=person "

{{getvar::non-human_traits}}"|
	:}|

/foreach var=quirks {:
	/ife {: /test left={{index}} right=0 rule=neq :}|
		/then {:
			/addvar key=person ", {{item}}"|
		:}|
	/else {: /addvar key=person " {{item}}":}|
:}|
	:}|


/addvar key=person "

Quirks:"|
/foreach var=quirks {:
	/ife {: /test left={{index}} right=0 rule=neq :}|
		/then {:
			/addvar key=person ", {{item}}"|
		:}|
	/else {: /addvar key=person " {{item}}":}|
:}|

/setvar key=per Redo|
/while left=per right=Redo rule=eq {:
	/setvar key=t1 []|
	
	/setvar key=system {{noop}}|
	/setvar key=prompt {{noop}}|
	/setvar key=instruct {{noop}}|
	
	//Button 04 - 06|
	/getentryfield file="Character Maker Combined NSFW GenRaw" 186|
	/setvar key=system {{pipe}}|
	/getentryfield file="Character Maker Combined NSFW GenRaw" 187|
	/setvar key=prompt {{pipe}}|
	/getentryfield file="Character Maker Combined NSFW GenRaw" 188|
	/setvar key=instruct {{pipe}}|
	
	/genraw lock=on name={{char}} 
	system="{{getvar::system}}"
{{getvar::prompt}}
{{getvar::instruct}}|

	/addvar key=t1 {{pipe}}|
	/addvar key=t1 Edit|
	/addvar key=t1 Redo|
	
	/buttons labels={{getvar::t1}} Is this the personality you want for {{getvar::fname}}?|
	/setvar key=per {{pipe}} |
	/ife {: /test left=per right="" rule=eq :}|
		/then {:/:"Character Maker V4.Flushvar"| /echo Aborting | /abort:}|
	/elseif {: /test left=per right="Edit" rule=eq :}|
		/then {:
			/getvar key=t1 index=0| /setvar key=t {{pipe}}|
			/input rows=8 default={{getvar::t}} Edit the personality to youor likeing.|
			/setvar key=per {{pipe}}|
			/ife {: /test left=p1 right="" rule=eq :}|
				/then {: /:"Character Maker V4.Flushvar"| /echo Aborting | /abort :}|
				
		:}|
	
:}|
/setvar key=personality {{getvar::per}}|
/setvar key=form " {{getvar::form}}"|
/addvar key=person "

Personality: {{getvar::personality}}"|

/message-edit message={{lastMessageId}} "<h2 align='center'>{{getvar::catgen}}{{getvar::form}}</h2>

{{getvar::person}}"